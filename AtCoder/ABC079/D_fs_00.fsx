#r "nuget: FsUnit"
open FsUnit

let H,W,Ca,Aa = 2,4,[|[|0;9;9;9;9;9;9;9;9;9|];[|9;0;9;9;9;9;9;9;9;9|];[|9;9;0;9;9;9;9;9;9;9|];[|9;9;9;0;9;9;9;9;9;9|];[|9;9;9;9;0;9;9;9;9;2|];[|9;9;9;9;9;0;9;9;9;9|];[|9;9;9;9;9;9;0;9;9;9|];[|9;9;9;9;9;9;9;0;9;9|];[|9;9;9;9;2;9;9;9;0;9|];[|9;2;9;9;9;9;9;9;9;0|]|],[|[|-1;-1;-1;-1|];[|8;1;1;8|]|]
let H,W,Ca,Aa = 3,5,[|[|0;4;3;6;2;7;2;5;3;3|];[|4;0;5;3;7;5;3;7;2;7|];[|5;7;0;7;2;9;3;2;9;1|];[|3;6;2;0;2;4;6;4;2;3|];[|3;5;7;4;0;6;9;7;6;7|];[|9;8;5;2;2;0;4;7;6;5|];[|5;4;6;3;2;3;0;5;4;3|];[|3;6;2;3;4;2;4;0;8;9|];[|4;6;5;4;3;5;3;2;0;8|];[|2;1;3;4;5;7;8;6;4;0|]|],[|[|3;5;2;6;1|];[|2;5;3;2;1|];[|6;9;2;5;6|]|]
let solve H W Ca Aa =
  let Ra = array2D Ca
  for k in 0..9 do for i in 0..9 do for j in 0..9 do Ra.[i,j] <- min Ra.[i,j] (Ra.[i,k]+Ra.[k,j])
  Aa |> Array.concat |> Array.filter (fun i -> i<>1 && i<>(-1))
  |> (fun a -> if Array.isEmpty a then 0 else Array.sumBy (fun i -> Ra.[i,1]) a)

let H,W = stdin.ReadLine().Split() |> Array.map int |> (fun x -> x.[0],x.[1])
let Ca = [| for i in 1..10 do (stdin.ReadLine().Split() |> Array.map int) |]
let Aa = [| for i in 1..H do (stdin.ReadLine().Split() |> Array.map int) |]
solve H W Ca Aa |> stdout.WriteLine

solve 2 4 [|[|0;9;9;9;9;9;9;9;9;9|];[|9;0;9;9;9;9;9;9;9;9|];[|9;9;0;9;9;9;9;9;9;9|];[|9;9;9;0;9;9;9;9;9;9|];[|9;9;9;9;0;9;9;9;9;2|];[|9;9;9;9;9;0;9;9;9;9|];[|9;9;9;9;9;9;0;9;9;9|];[|9;9;9;9;9;9;9;0;9;9|];[|9;9;9;9;2;9;9;9;0;9|];[|9;2;9;9;9;9;9;9;9;0|]|] [|[|-1;-1;-1;-1|];[|8;1;1;8|]|] |> should equal 12
solve 5 5 [|[|0;999;999;999;999;999;999;999;999;999|];[|999;0;999;999;999;999;999;999;999;999|];[|999;999;0;999;999;999;999;999;999;999|];[|999;999;999;0;999;999;999;999;999;999|];[|999;999;999;999;0;999;999;999;999;999|];[|999;999;999;999;999;0;999;999;999;999|];[|999;999;999;999;999;999;0;999;999;999|];[|999;999;999;999;999;999;999;0;999;999|];[|999;999;999;999;999;999;999;999;0;999|];[|999;999;999;999;999;999;999;999;999;0|];|] [|[|1;1;1;1;1|];[|1;1;1;1;1|];[|1;1;1;1;1|];[|1;1;1;1;1|];[|1;1;1;1;1|]|] |> should equal 0
solve 3 5 [|[|0;4;3;6;2;7;2;5;3;3|];[|4;0;5;3;7;5;3;7;2;7|];[|5;7;0;7;2;9;3;2;9;1|];[|3;6;2;0;2;4;6;4;2;3|];[|3;5;7;4;0;6;9;7;6;7|];[|9;8;5;2;2;0;4;7;6;5|];[|5;4;6;3;2;3;0;5;4;3|];[|3;6;2;3;4;2;4;0;8;9|];[|4;6;5;4;3;5;3;2;0;8|];[|2;1;3;4;5;7;8;6;4;0|]|] [|[|3;5;2;6;1|];[|2;5;3;2;1|];[|6;9;2;5;6|]|] |> should equal 47

#r "nuget: FsUnit"
open FsUnit
"TODO: 以下のコードはTLE"
let H,W,Aa = 3,4,[|[|'.';'.';'.';'#'|];[|'.';'#';'.';'.'|];[|'.';'.';'.';'.'|]|]
let solve H W (Aa:char[][]) =
    let (+%) n m = (n+m) % ((pown 10 9) + 7)
    let memorec f =
        let memo = System.Collections.Generic.Dictionary<_,_>()
        let rec frec j =
            match memo.TryGetValue j with
                | exist, value when exist -> value
                | _ -> let value = f frec j in memo.Add(j, value); value
        frec
    let rec f frec (i,j) =
        if (i,j)=(0,0) then 1
        elif Aa.[i].[j]='#' then 0
        elif i=0 then frec (i,j-1)
        elif j=0 then frec (i-1,j)
        else frec (i-1,j) +% frec (i,j-1)
    (memorec f) (H-1,W-1)
let H,W = stdin.ReadLine().Split() |> Array.map int |> (fun x -> x.[0], x.[1])
let Aa = [| for i in 1..H do (stdin.ReadLine() |> Seq.toArray) |]
solve H W Aa |> stdout.WriteLine

solve 3 4 [|[|'.';'.';'.';'#'|];[|'.';'#';'.';'.'|];[|'.';'.';'.';'.'|]|] |> should equal 3
solve 5 2 [|[|'.'; '.'|]; [|'#'; '.'|]; [|'.'; '.'|]; [|'.'; '#'|]; [|'.'; '.'|]|] |> should equal 0
solve 5 5 [|[|'.'; '.'; '#'; '.'; '.'|]; [|'.'; '.'; '.'; '.'; '.'|];[|'#'; '.'; '.'; '.'; '#'|]; [|'.'; '.'; '.'; '.'; '.'|];[|'.'; '.'; '#'; '.'; '.'|]|] |> should equal 24
solve 20 20 [|[|'.'; '.'; '.'; '.'; '.'; '.'; '.'; '.'; '.'; '.'; '.'; '.'; '.'; '.';'.'; '.'; '.'; '.'; '.'; '.'|];[|'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.'|];[|'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.'|];[|'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.'|];[|'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.'|];[|'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.'|];[|'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.'|];[|'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.'|];[|'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.'|];[|'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.'|];[|'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.'|];[|'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.'|];[|'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.'|];[|'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.'|];[|'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.'|];[|'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.'|];[|'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.'|];[|'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.'|];[|'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.'|];[|'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.';'.'|]|] |> should equal 345263555

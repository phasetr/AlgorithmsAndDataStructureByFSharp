# README
- <https://atcoder.jp/contests/dp/tasks/dp_r>

## 問題
>N 頂点の単純有向グラフ G があります。
>頂点には 1, 2, \ldots, N と番号が振られています。
>
>各 i, j (1 \leq i, j \leq N) について、
>頂点 i から j への有向辺の有無が整数 a_{i, j} によって与えられます。
>a_{i, j} = 1 ならば頂点 i から j への有向辺が存在し、a_{i, j} = 0 ならば存在しません。
>
>G の長さ K の有向パスは何通りでしょうか？
>10^9 + 7 で割った余りを求めてください。
>ただし、同じ辺を複数回通るような有向パスも数えるものとします。
>
>制約
>
>* 入力はすべて整数である。
>* 1 \leq N \leq 50
>* 1 \leq K \leq 10^{18}
>* a_{i, j} は 0 または 1 である。
>* a_{i, i} = 0

## 解説
- <https://kyopro-friends.hatenablog.com/entry/2019/01/12/231035>

>長さKのパスを考えるのだから、とりあえず始点と終点を状態として
>
>```
>dp[n][i][j]=(頂点iから頂点jへ行く長さnのパスの個数)
>```
>
>というのを考えてみるわ。状態遷移は
>
>```
>dp[n][i][j]=∑kdp[n−1][i][k]∗a[k][j]
>```
>
>となるわね。ところで、この積の形、よくみると行列の積と同じね！
>dp[n][i][j]を(i,j)成分とする行列をDPnと書くことにすると、
>さっきの漸化式は
>
>```
>DP_n=DP_{n−1}A
>```
>
>になるわ。
>DP_0は明らかに単位行列だから、DP_n=A^nね。
>求める答えは∑i,jdp[K][i][j]だから、
>A^Kを計算すれば求められるわよ。
>
>```
>matrixpow(A,K,MOD);//Aをmod MODでK乗する
>rep(i,1,N+1)rep(j,1,N+1)ans=(ans+A[i][j])%MOD;
>```
>
>行列の積は1回あたりO(N^3)、
>繰り返し二乗法を使えば積を計算する回数はO(logK)だから、
>O(N^3 log K)で求められるわね。
>
>「行列の積と同じ式になってると気づくのは無理じゃない？」
>そうね、こればっかりは知ってるかどうかになりそうね。
>行列累乗で解く問題は、次の２つのポイントを抑えておくといいわ。
>どっちも決め手になるほどじゃないけど……
>
>・ポイント１：制約をみる
>N≤50くらい、Kは109とか1018とかの大きな値、
>みたいな制約の問題は、サイズN×Nの行列をK乗するかも。
>・ポイント２：繰り返し
>今回の状態遷移の式を見ると、回数nが遷移に影響しないわね。
>こういうふうに同じ状態遷移を何度も繰り返すものは、行列累乗かも。

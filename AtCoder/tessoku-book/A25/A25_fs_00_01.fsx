#r "nuget: FsUnit"
open FsUnit

(*
let H,W,Ia = 4,8,[|".....#..";"........";"..#...#.";"#......."|]
let H,W,Ia = 2,8,[|"....#...";"....#..."|]
*)
let solve H W Ia =
  let Ma =
    let Ma = Array2D.create (H+2) (W+2) '#'
    Ia |> array2D |> Array2D.iteri (fun i j c -> Array2D.set Ma (i+1) (j+1) c) |> ignore
    Ma
  Array2D.create (H+1) (W+1) 0L
  |> fun dp -> Array2D.set dp 1 1 1L; dp
  |> fun dp -> (dp, [|1..W|])
  ||> Array.fold (fun dp j ->
    [|1..H|] |> Array.iter (fun i ->
      dp.[i,j] <-
        match (Ma.[i,j-1],Ma.[i-1,j]) with
          | '#','#' -> dp.[i,j]
          | '#','.' -> dp.[i-1,j]
          | '.','#' -> dp.[i,j-1]
          | _,_     -> dp.[i-1,j] + dp.[i,j-1])
    dp)
  |> fun dp -> dp.[H,W]

let H,W = stdin.ReadLine().Split() |> Array.map int |> (fun x -> x.[0],x.[1])
let Ia = Array.init H (fun _ -> stdin.ReadLine())
solve H W Ia |> stdout.WriteLine

solve 4 8 [|".....#..";"........";"..#...#.";"#......."|] |> should equal 35L
solve 2 8 [|"....#...";"....#..."|] |> should equal 0L
solve 30 30 [|"..............................";"..............................";"..............................";"..............................";"..............................";"..............................";"..............................";"..............................";"..............................";"..............................";"..............................";"..............................";"..............................";"..............................";"..............................";"..............................";"..............................";"..............................";"..............................";"..............................";"..............................";"..............................";"..............................";"..............................";"..............................";"..............................";"..............................";"..............................";"..............................";".............................."|] |> should equal 30067266499541040L
